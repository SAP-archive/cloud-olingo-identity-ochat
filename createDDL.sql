CREATE TABLE OCHAT_NOTIFICATION_TARGET (NOTIFICATION_TARGET_ID INTEGER NOT NULL, APPLICATION_NAME VARCHAR(256) NOT NULL, HOSTNAME VARCHAR(128) NOT NULL, USE_HTTPS INTEGER NOT NULL, NOTIFICATION_USER VARCHAR(128) NOT NULL, NOTIFICATION_PASSWORD VARCHAR(128), PORT INTEGER NOT NULL, PRIMARY KEY (NOTIFICATION_TARGET_ID))
CREATE TABLE OCHAT_MESSAGE_USER (MESSAGE_USER_ID BIGINT NOT NULL, UPDATEDTIMESTAMP TIMESTAMP, USERNAME VARCHAR(255), PRIMARY KEY (MESSAGE_USER_ID))
CREATE TABLE OCHAT_MESSAGE_GROUP (MESSAGE_GROUP_ID BIGINT NOT NULL, NAME VARCHAR(255), UPDATEDTIMESTAMP TIMESTAMP, PRIMARY KEY (MESSAGE_GROUP_ID))
CREATE TABLE OCHAT_MESSAGE (MESSAGE_ID BIGINT NOT NULL, TEXT VARCHAR(255), UPDATEDTIMESTAMP TIMESTAMP, MESSAGE_GROUP_ID BIGINT, SENDER BIGINT, PRIMARY KEY (MESSAGE_ID))
CREATE TABLE OCHAT_USER_GROUP (MESSAGE_USER_ID BIGINT NOT NULL, MESSAGE_GROUP_ID BIGINT NOT NULL, PRIMARY KEY (MESSAGE_USER_ID, MESSAGE_GROUP_ID))
ALTER TABLE OCHAT_NOTIFICATION_TARGET ADD CONSTRAINT UNQ_OCHAT_NOTIFICATION_TARGET_0 UNIQUE (HOSTNAME, APPLICATION_NAME)
ALTER TABLE OCHAT_MESSAGE_USER ADD CONSTRAINT UNQ_OCHAT_MESSAGE_USER_2 UNIQUE (USERNAME)
ALTER TABLE OCHAT_MESSAGE ADD CONSTRAINT FK_OCHAT_MESSAGE_SENDER FOREIGN KEY (SENDER) REFERENCES OCHAT_MESSAGE_USER (MESSAGE_USER_ID)
ALTER TABLE OCHAT_MESSAGE ADD CONSTRAINT FK_OCHAT_MESSAGE_MESSAGE_GROUP_ID FOREIGN KEY (MESSAGE_GROUP_ID) REFERENCES OCHAT_MESSAGE_GROUP (MESSAGE_GROUP_ID)
ALTER TABLE OCHAT_USER_GROUP ADD CONSTRAINT FK_OCHAT_USER_GROUP_MESSAGE_GROUP_ID FOREIGN KEY (MESSAGE_GROUP_ID) REFERENCES OCHAT_MESSAGE_GROUP (MESSAGE_GROUP_ID)
ALTER TABLE OCHAT_USER_GROUP ADD CONSTRAINT FK_OCHAT_USER_GROUP_MESSAGE_USER_ID FOREIGN KEY (MESSAGE_USER_ID) REFERENCES OCHAT_MESSAGE_USER (MESSAGE_USER_ID)
CREATE TABLE OCHAT_ID_GENERATOR (GENERATOR_NAME VARCHAR(50) NOT NULL, GENERATOR_VALUE NUMERIC(38), PRIMARY KEY (GENERATOR_NAME))
INSERT INTO OCHAT_ID_GENERATOR(GENERATOR_NAME, GENERATOR_VALUE) values ('NotificationTarget', 0)
INSERT INTO OCHAT_ID_GENERATOR(GENERATOR_NAME, GENERATOR_VALUE) values ('Message', 0)
INSERT INTO OCHAT_ID_GENERATOR(GENERATOR_NAME, GENERATOR_VALUE) values ('MessageUser', 999)
INSERT INTO OCHAT_ID_GENERATOR(GENERATOR_NAME, GENERATOR_VALUE) values ('MessageGroup', 0)
